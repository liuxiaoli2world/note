# 浏览器渲染原理

>  从用户输入 `url`，到看到页面内容，经历了一下请求、响应、浏览器渲染三大步骤，本文主要讲解第三个步骤。

## 步骤

1. 获取 `html` 后，浏览器开辟出一块内存，用来给代码的执行提供环境；同时分配一个主线程去一行一行的解析和执行代码
2. 遇到 `script` 、 `link`、`img` 标签后浏览器会开辟新线程去加载资源。
3. 根据 `html` 代码生成 `DOM树`
4. `Render Tree`
5. 根据返回的 `css` 代码生成 `CSSOM`
6. 回流
7. 重绘
8. 显示

*浏览器有多个线程，但是执行 `js` 代码的只有一个线程*



## 优化

> 根据浏览器执行的流程可以分析出以下两个优化点。

### 减少请求数

1. 压缩代码

2. 图片懒加载

3. 音视频走流文件

4. 雪碧图

   ...

### 避免DOM回流

1. 不操作 `DOM`， 如现在的框架  `Angular` 、 `Vue`、`React`  
2. 读写分离 （写中不穿插读）
3. 样式集中修改（class）
4. 缓存（实际上也是读写分离）
5. 批量修改（使用文档碎片createDocumentFragment，模板字符串等）
6. 动画效果应用到`position` 属性为 `fixed`、`absolute`的元素上（脱离文档流，减小影响面）
7. `CSS3` 硬件加速（transform、opacity、filters...属性会触发硬件加速）
8. 牺牲平滑度换取速度
9. 避免 `table` 布局